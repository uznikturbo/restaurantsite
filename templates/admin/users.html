{% extends "base.html" %}
{% block title %}Користувачі — Адмін{% endblock %}

{% block extra_css %}
<style>
.admin-nav { display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:2.5rem;padding-bottom:1.5rem;border-bottom:1px solid rgba(26,18,8,.08); }
.admin-nav a { padding:.5rem 1.25rem;border-radius:2px;font-size:.78rem;letter-spacing:.08em;text-transform:uppercase;text-decoration:none;border:1px solid rgba(26,18,8,.15);color:rgba(26,18,8,.55);transition:all .2s; }
.admin-nav a:hover { border-color:var(--ink);color:var(--ink); }
.admin-nav a.active { background:var(--ink);color:#fff;border-color:var(--ink); }

.page-head { margin-bottom:2.5rem; }
.page-head__eyebrow { font-size:.7rem;letter-spacing:.2em;text-transform:uppercase;color:var(--gold);margin-bottom:.4rem; }
.page-head__title { font-family:'Cormorant Garamond',serif;font-size:2.2rem;font-weight:300; }

.users-card { background:#fff;border:1px solid rgba(26,18,8,.07);border-radius:6px;overflow:hidden; }
.users-card__head { padding:1.25rem 1.5rem;border-bottom:1px solid rgba(26,18,8,.06); }
.users-card__title { font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:400; }

table { width:100%;border-collapse:collapse; }
th { padding:.75rem 1rem;text-align:left;font-size:.72rem;letter-spacing:.1em;text-transform:uppercase;color:rgba(26,18,8,.4);border-bottom:1px solid rgba(26,18,8,.08); }
td { padding:.9rem 1rem;border-bottom:1px solid rgba(26,18,8,.05);font-size:.88rem; }
tr:last-child td { border:none; }
tbody tr:hover { background:var(--paper); }

.avatar { width:40px;height:40px;border-radius:50%;background:var(--ink);color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-weight:300; }

@media (max-width:700px) {
    th:nth-child(3),td:nth-child(3),th:nth-child(5),td:nth-child(5),th:nth-child(7),td:nth-child(7) { display:none; }
}
</style>
{% endblock %}

{% block content %}
<nav class="admin-nav">
    <a href="{{ url_for('main.admin_dashboard') }}">Дашборд</a>
    <a href="{{ url_for('main.admin_orders') }}">Замовлення</a>
    <a href="{{ url_for('main.admin_products') }}">Товари</a>
    <a href="{{ url_for('main.admin_users') }}" class="active">Користувачі</a>
    <a href="{{ url_for('main.admin_tables') }}">Столики</a>
</nav>

<div class="page-head">
    <div class="page-head__eyebrow">Адміністрування</div>
    <h1 class="page-head__title">Користувачі</h1>
</div>

<div class="users-card">
    <div class="users-card__head">
        <div class="users-card__title">Список користувачів — {{ users|length }}</div>
    </div>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Аватар</th>
                <th>Email</th>
                <th>Ім'я</th>
                <th>Телефон</th>
                <th>Роль</th>
                <th>Статус</th>
                <th>Реєстрація</th>
                <th>Дія</th>
            </tr>
        </thead>
        <tbody>
            {% for u in users %}
            <tr>
                <td>{{ u.id }}</td>
                <td><div class="avatar">{{ u.email[0].upper() }}</div></td>
                <td>{{ u.email }}</td>
                <td>{{ u.username or '—' }}</td>
                <td>{{ u.phone or '—' }}</td>
                <td>
                    {% if u.is_admin %}
                        <span class="badge badge--admin">Адмін</span>
                    {% else %}
                        <span class="badge badge--user">Юзер</span>
                    {% endif %}
                </td>
                <td>
                    {% if u.is_active %}
                        <span class="badge badge--active">Активний</span>
                    {% else %}
                        <span class="badge badge--deleted">Неакт.</span>
                    {% endif %}
                </td>
                <td>{{ u.created_at.strftime('%d.%m.%Y') }}</td>
                <td>
                    <form action="{{ url_for('main.admin_toggle_user_admin', user_id=u.id) }}" method="POST" style="margin:0">
                        {{ toggle_forms[u.id].hidden_tag() }}
                        <button type="submit" class="btn btn--ghost" style="padding:.35rem .8rem;font-size:.75rem">
                            {{ 'Зняти' if u.is_admin else 'Адмін' }}
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
