{% extends "base.html" %}

{% block title %}–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —Å—Ç–æ–ª–∏–∫–∞ - Ê°ú„É¨„Çπ„Éà„É©„É≥{% endblock %}

{% block extra_css %}
<style>
/* ================== BASE ================== */
.booking-container {
    max-width: 1600px;
    margin: 2rem auto;
    padding: 0 2rem;
    animation: fadeIn 1s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.booking-content {
    display: grid;
    grid-template-columns: 1fr 420px;
    gap: 3rem;
    align-items: start;
}

/* ================== HERO ================== */
.booking-hero {
    background: linear-gradient(135deg, rgba(212,40,45,.95), rgba(26,26,26,.9)),
        url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1600') center/cover;
    padding: 4rem;
    border-radius: 25px;
    text-align: center;
    color: #fff;
    margin-bottom: 3rem;
    box-shadow: 0 20px 50px rgba(0,0,0,.3);
}

.booking-hero h1 {
    font-family: 'Noto Serif JP', serif;
    font-size: 3.5rem;
    margin-bottom: 1rem;
}

.booking-hero p {
    font-size: 1.3rem;
    opacity: .9;
}

/* ================== LAYOUT ================== */
.restaurant-layout {
    background: linear-gradient(135deg, #1a1a1a, #2c2c2c);
    padding: 2rem;
    border-radius: 25px;
    box-shadow: 0 20px 50px rgba(0,0,0,.3);
    overflow: hidden; /* –©–æ–± –Ω—ñ—á–æ–≥–æ –Ω–µ –≤–∏–ª–∞–∑–∏–ª–æ –∑–∞ —Ä–∞–º–∫–∏ –∫–∞—Ä—Ç–∫–∏ */
}

.layout-header {
    text-align: center;
    margin-bottom: 2rem;
}

.layout-header h2 {
    color: #fff;
    font-family: 'Noto Serif JP', serif;
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.layout-header p {
    color: rgba(255,255,255,.7);
    font-size: 1rem;
}

.layout-legend {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
}

.legend-item {
    color: #fff;
    background: rgba(255,255,255,.1);
    padding: .7rem 1.3rem;
    border-radius: 50px;
    font-size: 0.95rem;
    backdrop-filter: blur(10px);
}

/* ================== FLOOR (–í—ñ–∫–Ω–æ –ø–µ—Ä–µ–≥–ª—è–¥—É) ================== */
.restaurant-floor {
    background: linear-gradient(135deg, #a0826d, #8b6f5b);
    padding: 20px;
    border-radius: 20px;
    border: 3px solid #d4282d;
    box-shadow: inset 0 4px 20px rgba(0,0,0,.2);
    
    /* –î–æ–¥–∞—î–º–æ —Å–∫—Ä–æ–ª, —è–∫—â–æ —Å—Ö–µ–º–∞ –Ω–µ –≤–º—ñ—â—É—î—Ç—å—Å—è */
    overflow-x: auto;
    overflow-y: hidden;
    position: relative;
    
    /* –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è —Å–∫—Ä–æ–ª–±–∞—Ä—É */
    scrollbar-width: thin;
    scrollbar-color: #d4282d #2c2c2c;
}

.restaurant-floor::-webkit-scrollbar {
    height: 8px;
}
.restaurant-floor::-webkit-scrollbar-track {
    background: #2c2c2c;
    border-radius: 4px;
}
.restaurant-floor::-webkit-scrollbar-thumb {
    background-color: #d4282d;
    border-radius: 4px;
}

/* ================== TABLES CONTAINER (–ö–∞—Ä—Ç–∞) ================== */
.tables-container {
    position: relative;
    /* –§—ñ–∫—Å–æ–≤–∞–Ω–∞ —à–∏—Ä–∏–Ω–∞ "–∫–∞—Ä—Ç–∏". –¶–µ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –Ω–µ –ø–æ—ó–¥—É—Ç—å */
    min-width: 900px; 
    height: 600px; 
    margin: 0 auto;
}

/* –®–∞—Ä –¥–ª—è —Å—Ç–æ–ª–∏–∫—ñ–≤, —â–æ–± –≤—ñ–¥–¥—ñ–ª–∏—Ç–∏ —ó—Ö –≤—ñ–¥ –±–∞—Ä—É */
.tables-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
}

/* ================== BAR COUNTER ================== */
.bar-counter {
    position: absolute;
    right: 0; /* –ü—Ä–∏—Ç–∏—Å–Ω—É—Ç–∏–π –¥–æ –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—é –∫–∞—Ä—Ç–∏ */
    top: 50%;
    transform: translateY(-50%);
    width: 80px;
    height: 400px;
    background: linear-gradient(180deg, #4a3021, #2d1f15);
    border-radius: 15px 0 0 15px;
    border: 4px solid #1a0f0a;
    border-right: none;
    box-shadow: 
        -5px 10px 30px rgba(0,0,0,.6),
        inset 0 2px 10px rgba(255,255,255,.1);
    z-index: 5;
}

.bar-top {
    position: absolute;
    top: -8px;
    left: -5px;
    right: 0;
    height: 15px;
    background: linear-gradient(180deg, #8b4513, #654321);
    border-radius: 8px 0 0 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,.4);
}

.bar-stools {
    position: absolute;
    left: -35px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 40px;
}

.bar-stool {
    width: 30px;
    height: 30px;
    background: radial-gradient(circle at 30% 30%, #d4282d, #8b1a1f);
    border-radius: 50%;
    border: 3px solid #5a0f13;
    box-shadow: 0 4px 12px rgba(0,0,0,.5);
}

.bar-stool::after {
    content: '';
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    width: 4px;
    height: 20px;
    background: #3d2817;
    border-radius: 2px;
}

.bar-label {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #f4c430;
    font-family: 'Noto Serif JP', serif;
    font-weight: bold;
    font-size: 0.9rem;
    writing-mode: vertical-rl;
    text-orientation: mixed;
    letter-spacing: 3px;
    text-shadow: 2px 2px 4px rgba(0,0,0,.5);
}

.bar-bottles {
    position: absolute;
    right: 5px;
    top: 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.bottle {
    width: 8px;
    height: 25px;
    background: linear-gradient(180deg, rgba(255,255,255,.3), rgba(139,69,19,.5));
    border-radius: 2px;
    box-shadow: inset 0 1px 2px rgba(255,255,255,.2);
}

/* ================== TABLE WRAPPER ================== */
.table-wrapper {
    position: absolute;
    display: inline-block;
    cursor: pointer;
    transition: all .3s ease;
    user-select: none;
}

.table-wrapper:hover:not(.occupied) {
    transform: scale(1.08);
    filter: brightness(1.1);
    z-index: 20;
}

.table-wrapper.occupied {
    opacity: .4;
    cursor: not-allowed;
    filter: grayscale(70%);
}

.table-wrapper.selected {
    transform: scale(1.12);
    z-index: 30;
}

.table-wrapper.selected::before {
    content: '‚òÖ';
    position: absolute;
    top: -25px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2rem;
    color: #fbbf24;
    animation: starPulse 1.5s infinite;
}

@keyframes starPulse {
    0%, 100% { transform: translateX(-50%) scale(1); }
    50% { transform: translateX(-50%) scale(1.2); }
}

/* ================== TABLE ================== */
.japanese-table {
    position: relative;
    display: inline-block;
}

/* Round table - 2 –º—ñ—Å—Ü—è */
.japanese-table.round {
    width: 100px;
    height: 100px;
}

/* Square table - 4 –º—ñ—Å—Ü—è */
.japanese-table.square {
    width: 100px;
    height: 100px;
}

/* Large table - 6 –º—ñ—Å—Ü—å */
.japanese-table.large {
    width: 160px;
    height: 90px;
}

.table-top {
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at 30% 30%, #a0522d, #6b3410);
    border: 4px solid #4a2511;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 
        0 8px 25px rgba(0,0,0,.5),
        inset 0 2px 5px rgba(255,255,255,.2);
    position: relative;
}

.japanese-table.round .table-top {
    border-radius: 50%;
}

.japanese-table.square .table-top {
    border-radius: 15px;
}

.japanese-table.large .table-top {
    border-radius: 20px;
}

/* ================== TABLE NUMBER ================== */
.table-number-display {
    font-size: 1.8rem;
    font-weight: bold;
    color: #f4c430;
    font-family: 'Noto Serif JP', serif;
    text-shadow: 2px 2px 4px rgba(0,0,0,.5);
    z-index: 2;
}

/* ================== CHAIRS (CUSHIONS) ================== */
.chair {
    position: absolute;
    width: 30px;
    height: 30px;
    background: radial-gradient(circle at 30% 30%, #d4282d, #8b1a1f);
    border-radius: 50%;
    border: 3px solid #5a0f13;
    box-shadow: 0 4px 12px rgba(0,0,0,.5);
    z-index: 1;
}

/* ROUND TABLE - 2 —Å—Ç—ñ–ª—å—Ü—ñ */
.japanese-table.round .chair:nth-child(1) {
    top: -17px;
    left: 50%;
    transform: translateX(-50%);
}

.japanese-table.round .chair:nth-child(2) {
    bottom: -17px;
    left: 50%;
    transform: translateX(-50%);
}

/* SQUARE TABLE - 4 —Å—Ç—ñ–ª—å—Ü—ñ */
.japanese-table.square .chair:nth-child(1) {
    top: -17px;
    left: 50%;
    transform: translateX(-50%);
}

.japanese-table.square .chair:nth-child(2) {
    right: -17px;
    top: 50%;
    transform: translateY(-50%);
}

.japanese-table.square .chair:nth-child(3) {
    bottom: -17px;
    left: 50%;
    transform: translateX(-50%);
}

.japanese-table.square .chair:nth-child(4) {
    left: -17px;
    top: 50%;
    transform: translateY(-50%);
}

/* LARGE TABLE - 6 —Å—Ç—ñ–ª—å—Ü—ñ–≤ */
.japanese-table.large .chair {
    width: 28px;
    height: 28px;
}

.japanese-table.large .chair:nth-child(1) {
    top: -16px;
    left: 15%;
}

.japanese-table.large .chair:nth-child(2) {
    top: -16px;
    left: 50%;
    transform: translateX(-50%);
}

.japanese-table.large .chair:nth-child(3) {
    top: -16px;
    right: 15%;
}

.japanese-table.large .chair:nth-child(4) {
    bottom: -16px;
    left: 15%;
}

.japanese-table.large .chair:nth-child(5) {
    bottom: -16px;
    left: 50%;
    transform: translateX(-50%);
}

.japanese-table.large .chair:nth-child(6) {
    bottom: -16px;
    right: 15%;
}

/* ================== STATUS BADGE ================== */
.status-badge {
    position: absolute;
    top: -12px;
    right: -12px;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    font-weight: bold;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 10px rgba(0,0,0,.3);
    z-index: 3;
    border: 2px solid white;
}

.status-available {
    background: #10b981;
    color: #fff;
}

.status-occupied {
    background: #ef4444;
    color: #fff;
}

/* ================== BOOKING FORM ================== */
.booking-form-container {
    background: linear-gradient(180deg, #ffffff, #fafafa);
    padding: 2.8rem;
    border-radius: 30px;
    box-shadow:
        0 20px 40px rgba(0,0,0,.12),
        inset 0 1px 0 rgba(255,255,255,.8);
    position: sticky;
    top: 100px;
    border: 1px solid rgba(0,0,0,.05);
}

.form-header {
    text-align: center;
    margin-bottom: 2rem;
}

.form-header h2 {
    font-family: 'Noto Serif JP', serif;
    font-size: 2.2rem;
    color: #d4282d;
    letter-spacing: .5px;
    margin-bottom: 0.8rem;
}

.form-header::after {
    content: "‚îÅ‚îÅ‚îÅ ‚ú¶ ‚îÅ‚îÅ‚îÅ";
    display: block;
    color: #f4c430;
    font-size: .9rem;
}

.info-message {
    background: linear-gradient(135deg, #dbeafe, #bfdbfe);
    color: #1e40af;
    padding: 1.2rem 1.5rem;
    border-radius: 15px;
    font-size: .95rem;
    margin-bottom: 1.5rem;
    border-left: 4px solid #3b82f6;
}

.selected-table-info {
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    border-radius: 20px;
    padding: 1.8rem;
    margin-bottom: 2rem;
    text-align: center;
    border: 2px solid #f59e0b;
    box-shadow: 0 10px 25px rgba(245,158,11,.3);
}

.selected-table-info h3 {
    font-size: 1.8rem;
    color: #92400e;
    margin-bottom: .5rem;
    font-family: 'Noto Serif JP', serif;
}

.selected-table-info p {
    font-size: 1.1rem;
    color: #78350f;
    font-weight: 600;
}

.booking-form {
    display: flex;
    flex-direction: column;
    gap: 1.6rem;
}

.form-group {
    position: relative;
}

.form-label {
    display: block;
    font-weight: 600;
    color: #374151;
    margin-bottom: .6rem;
    font-size: .95rem;
}

.form-input,
.form-select,
.form-textarea {
    width: 100%;
    padding: 1.1rem 1.5rem;
    border-radius: 16px;
    border: 2px solid #e5e7eb;
    font-size: 1rem;
    background: #fff;
    transition: all .3s ease;
    font-family: inherit;
}

.form-input:hover,
.form-select:hover,
.form-textarea:hover {
    border-color: #f4c430;
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: #d4282d;
    box-shadow: 0 0 0 4px rgba(212,40,45,.15);
}

.form-textarea {
    min-height: 110px;
    resize: vertical;
}

.submit-btn {
    margin-top: 1rem;
    padding: 1.3rem;
    border-radius: 60px;
    background: linear-gradient(135deg, #d4282d, #b01f24);
    color: #fff;
    font-size: 1.25rem;
    font-weight: 700;
    border: none;
    cursor: pointer;
    box-shadow:
        0 10px 25px rgba(212,40,45,.4),
        inset 0 2px 0 rgba(255,255,255,.2);
    transition: all .3s ease;
}

.submit-btn:hover:not(:disabled) {
    transform: translateY(-3px);
    box-shadow:
        0 15px 35px rgba(212,40,45,.55),
        inset 0 2px 0 rgba(255,255,255,.25);
}

.submit-btn:disabled {
    background: linear-gradient(135deg, #d1d5db, #9ca3af);
    box-shadow: none;
    cursor: not-allowed;
    opacity: 0.6;
}

/* ================== SPECIAL OFFERS ================== */
.special-offers {
    margin-top: 4rem;
    background: white;
    padding: 3rem;
    border-radius: 25px;
    box-shadow: 0 10px 30px rgba(0,0,0,.1);
}

.special-offers h3 {
    font-family: 'Noto Serif JP', serif;
    font-size: 2rem;
    color: #d4282d;
    text-align: center;
    margin-bottom: 2rem;
}

.offers-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
}

.offer-card {
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    padding: 2rem;
    border-radius: 20px;
    text-align: center;
    transition: .3s;
    border: 2px solid transparent;
}

.offer-card:hover {
    transform: translateY(-5px);
    border-color: #f59e0b;
    box-shadow: 0 15px 30px rgba(245,158,11,.3);
}

.offer-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

.offer-title {
    font-size: 1.3rem;
    font-weight: 700;
    color: #92400e;
    margin-bottom: 0.5rem;
}

.offer-description {
    color: #78350f;
    font-size: 0.95rem;
}

/* ================== RESPONSIVE ================== */
@media (max-width: 1200px) {
    .booking-content {
        grid-template-columns: 1fr;
    }
    
    .booking-form-container {
        position: relative;
        top: 0;
    }
}

@media (max-width: 768px) {
    .booking-hero h1 {
        font-size: 2.5rem;
    }
    
    /* –ó–º—ñ–Ω—é—î–º–æ –ø–∞–¥–¥—ñ–Ω–≥–∏ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–æ–≥–æ, –∞–ª–µ —Å–∫—Ä–æ–ª –≤ .restaurant-floor –≤—Å–µ –≤–∏—Ä—ñ—à—É—î */
    .restaurant-floor {
        padding: 1rem;
    }
    
    .booking-form-container {
        padding: 2rem;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="booking-container">
    <div class="booking-hero">
        <h1>üèÆ –ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –°—Ç–æ–ª–∏–∫–∞</h1>
        <p>–û–±–µ—Ä—ñ—Ç—å —ñ–¥–µ–∞–ª—å–Ω–µ –º—ñ—Å—Ü–µ –¥–ª—è –≤–∞—à–æ–≥–æ –≤—ñ–∑–∏—Ç—É</p>
    </div>

    <div class="booking-content">
        <div class="restaurant-layout">
            <div class="layout-header">
                <h2>üèØ –ü–ª–∞–Ω –†–µ—Å—Ç–æ—Ä–∞–Ω—É</h2>
                <p>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —Å—Ç–æ–ª–∏–∫ –¥–ª—è –≤–∏–±–æ—Ä—É</p>
            </div>

            <div class="layout-legend">
                <div class="legend-item">‚úì –í—ñ–ª—å–Ω–∏–π</div>
                <div class="legend-item">‚òÖ –û–±—Ä–∞–Ω–∏–π</div>
                <div class="legend-item">‚úó –ó–∞–π–Ω—è—Ç–∏–π</div>
            </div>

            <div class="restaurant-floor">
                <div class="tables-container" id="tablesContainer">
                    
                    <div id="tablesLayer" class="tables-layer"></div>
                    
                    <div class="bar-counter">
                        <div class="bar-top"></div>
                        <div class="bar-label">BAR</div>
                        <div class="bar-bottles">
                            <div class="bottle"></div>
                            <div class="bottle"></div>
                            <div class="bottle"></div>
                            <div class="bottle"></div>
                            <div class="bottle"></div>
                        </div>
                        <div class="bar-stools">
                            <div class="bar-stool"></div>
                            <div class="bar-stool"></div>
                            <div class="bar-stool"></div>
                            <div class="bar-stool"></div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="booking-form-container">
            <div class="form-header">
                <h2>üìù –î–µ—Ç–∞–ª—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è</h2>
            </div>

            <div class="info-message" id="infoMessage">
                ‚ÑπÔ∏è –°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å —Å—Ç–æ–ª–∏–∫ –Ω–∞ –ø–ª–∞–Ω—ñ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É
            </div>

            <div class="selected-table-info" id="selectedTableInfo" style="display: none;">
                <h3>–°—Ç–æ–ª–∏–∫ #<span id="selectedTableNumber">-</span></h3>
                <p>–ú—ñ—Å—Ü—å: <span id="selectedTableSeats">-</span> üë•</p>
            </div>

            <form action="{{ url_for('create_reservation') }}" method="POST" class="booking-form" id="bookingForm">
                <input type="hidden" name="table_id" id="tableIdInput">

                <div class="form-group">
                    <label class="form-label">üìÖ –î–∞—Ç–∞ –≤—ñ–∑–∏—Ç—É *</label>
                    <input type="date" name="date" class="form-input" required id="dateInput">
                </div>

                <div class="form-group">
                    <label class="form-label">üïê –ß–∞—Å –≤—ñ–∑–∏—Ç—É *</label>
                    <input type="time" name="time" class="form-input" required id="timeInput">
                </div>

                <div class="form-group">
                    <label class="form-label">üë• –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ—Å—Ç–µ–π *</label>
                    <select name="guests" class="form-select" required id="guestsInput">
                        <option value="">–û–±–µ—Ä—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å</option>
                        <option value="1">1 –≥—ñ—Å—Ç—å</option>
                        <option value="2">2 –≥–æ—Å—Ç—ñ</option>
                        <option value="3">3 –≥–æ—Å—Ç—ñ</option>
                        <option value="4">4 –≥–æ—Å—Ç—ñ</option>
                        <option value="5">5 –≥–æ—Å—Ç–µ–π</option>
                        <option value="6">6 –≥–æ—Å—Ç–µ–π</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">üë§ –Ü–º'—è *</label>
                    <input type="text" name="name" class="form-input" required placeholder="–í–∞—à–µ —ñ–º'—è">
                </div>

                <div class="form-group">
                    <label class="form-label">üìû –¢–µ–ª–µ—Ñ–æ–Ω *</label>
                    <input type="tel" name="phone" class="form-input" required placeholder="+380 XX XXX XX XX">
                </div>

                <div class="form-group">
                    <label class="form-label">üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)</label>
                    <textarea name="comment" class="form-textarea" placeholder="–û—Å–æ–±–ª–∏–≤—ñ –ø–æ–±–∞–∂–∞–Ω–Ω—è, –∞–ª–µ—Ä–≥—ñ—ó, —Å–≤—è—Ç–∫—É–≤–∞–Ω–Ω—è..."></textarea>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn" disabled>
                    ‚ú® –ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏ —Å—Ç–æ–ª–∏–∫
                </button>
            </form>
        </div>
    </div>

    <div class="special-offers">
        <h3>üéâ –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó</h3>
        <div class="offers-grid">
            <div class="offer-card">
                <div class="offer-icon">üéÇ</div>
                <div class="offer-title">–î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</div>
                <div class="offer-description">–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –¥–µ—Å–µ—Ä—Ç –¥–ª—è —ñ–º–µ–Ω–∏–Ω–Ω–∏–∫–∞</div>
            </div>
            <div class="offer-card">
                <div class="offer-icon">üíë</div>
                <div class="offer-title">–†–æ–º–∞–Ω—Ç–∏—á–Ω–∞ –≤–µ—á–µ—Ä—è</div>
                <div class="offer-description">–°—Ç–æ–ª–∏–∫ –±—ñ–ª—è –≤—ñ–∫–Ω–∞ + —Å–≤—ñ—á–∫–∏</div>
            </div>
            <div class="offer-card">
                <div class="offer-icon">üçæ</div>
                <div class="offer-title">–ë—ñ–∑–Ω–µ—Å-–ª–∞–Ω—á</div>
                <div class="offer-description">–ó–Ω–∏–∂–∫–∞ 15% –∑ 12:00 –¥–æ 15:00</div>
            </div>
            <div class="offer-card">
                <div class="offer-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                <div class="offer-title">–°—ñ–º–µ–π–Ω–∞ –≤–µ—á–µ—Ä—è</div>
                <div class="offer-description">–î–∏—Ç—è—á–µ –º–µ–Ω—é –≤ –ø–æ–¥–∞—Ä—É–Ω–æ–∫</div>
            </div>
        </div>
    </div>
</div>

<script>
const tables = {{ tables_data | tojson }};
// –ú–∏ –∑–≤–µ—Ä—Ç–∞—î–º–æ—Å—å –¥–æ —à–∞—Ä—É –¥–ª—è —Å—Ç–æ–ª—ñ–≤, –∞ –Ω–µ –¥–æ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
const tablesLayer = document.getElementById('tablesLayer');
const submitBtn = document.getElementById('submitBtn');
const tableIdInput = document.getElementById('tableIdInput');
const selectedTableInfo = document.getElementById('selectedTableInfo');
const selectedTableNumber = document.getElementById('selectedTableNumber');
const selectedTableSeats = document.getElementById('selectedTableSeats');
const infoMessage = document.getElementById('infoMessage');

let selectedTableId = null;

// –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –º—ñ—Å—Ü—å –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É
function getSeatsCount(type) {
    const seatsMap = {
        'round': 2,
        'square': 4,
        'large': 6
    };
    return seatsMap[type] || 2;
}

// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—ñ–ª—å—Ü—ñ–≤
function createChairs(type) {
    const count = getSeatsCount(type);
    let html = '';
    for (let i = 0; i < count; i++) {
        html += `<div class="chair"></div>`;
    }
    return html;
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç–æ–ª–∏–∫—ñ–≤
function renderTables() {
    // –û—á–∏—â–∞—î–º–æ –ª–∏—à–µ —à–∞—Ä –∑—ñ —Å—Ç–æ–ª–∞–º–∏, –ë–∞—Ä –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–∞ –º—ñ—Å—Ü—ñ
    tablesLayer.innerHTML = '';

    tables.forEach(table => {
        const wrapper = document.createElement('div');
        wrapper.className = `table-wrapper ${table.available ? '' : 'occupied'}`;
        wrapper.style.left = table.x + 'px';
        wrapper.style.top = table.y + 'px';
        wrapper.dataset.tableId = table.id;

        const seats = getSeatsCount(table.type);

        wrapper.innerHTML = `
            <div class="japanese-table ${table.type}">
                ${createChairs(table.type)}
                <div class="table-top">
                    <div class="table-number-display">${table.number}</div>
                </div>
                <div class="status-badge ${table.available ? 'status-available' : 'status-occupied'}">
                    ${table.available ? '‚úì' : '‚úó'}
                </div>
            </div>
        `;

        if (table.available) {
            wrapper.addEventListener('click', () => selectTable(table, wrapper));
        }

        tablesLayer.appendChild(wrapper);
    });
}

// –í–∏–±—ñ—Ä —Å—Ç–æ–ª–∏–∫–∞
function selectTable(table, wrapper) {
    // –ó–Ω—è—Ç–∏ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –∑ —ñ–Ω—à–∏—Ö
    document.querySelectorAll('.table-wrapper').forEach(w => {
        w.classList.remove('selected');
    });

    // –í–∏–¥—ñ–ª–∏—Ç–∏ –æ–±—Ä–∞–Ω–∏–π
    wrapper.classList.add('selected');
    selectedTableId = table.id;

    // –û–Ω–æ–≤–∏—Ç–∏ —Ñ–æ—Ä–º—É
    tableIdInput.value = table.id;
    selectedTableNumber.textContent = table.number;
    selectedTableSeats.textContent = getSeatsCount(table.type);

    // –ü–æ–∫–∞–∑–∞—Ç–∏ —ñ–Ω—Ñ–æ –ø—Ä–æ –æ–±—Ä–∞–Ω–∏–π —Å—Ç–æ–ª–∏–∫
    selectedTableInfo.style.display = 'block';
    infoMessage.style.display = 'none';

    // –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫—É
    submitBtn.disabled = false;
}

// –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó –¥–∞—Ç–∏
const dateInput = document.getElementById('dateInput');
const today = new Date().toISOString().split('T')[0];
dateInput.min = today;
dateInput.value = today;

// –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —á–∞—Å—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
const timeInput = document.getElementById('timeInput');
timeInput.value = '19:00';

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
renderTables();
</script>

{% endblock %}